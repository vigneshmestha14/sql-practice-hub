# üåü Pyspark/SparkSQL Challenges & Solutions Repository


## üöÄ About This Repository
This repository contains comprehensive Pyspark/SparkSQL solutions for challenges.

‚úîÔ∏è Solutions are executed on **Microsoft Fabric Notebooks**.                                       
‚úîÔ∏è Categorized by difficulty: **Easy, Moderate, Hard, and Ninjas**.                               
‚úîÔ∏è Ideal for interview preparation with Pyspark problems from top companies like **Google, Amazon, Microsoft, Meta, and more**.

---

## üìå Table of Contents
- üü¢ [Easy](/Coding%20Ninjas/Easy)
- üü° [Moderate](/Coding%20Ninjas/Moderate)
- üî¥ [Hard](/Coding%20Ninjas/Hard)
- üü£ [Ninjas](/Coding%20Ninjas/Ninjas)

---


## üü¢ Difficulty: Easy (20/20) <a name="easy"></a>

| ID  | Challenge & Solution Script | Company |
|---- |-----------------------------|---------|
| 1   | [IMDb Metacritic Rating](/Coding%20Ninjas/Easy/01-%20IMDb%20Metacritic%20Rating/01-%20IMDb%20Metacritic%20Rating.ipynb) | TCS |
| 2   | [IMDb Max Weighted Rating](/Coding%20Ninjas/Easy/02-%20IMDb%20Max%20Weighted%20Rating/02-%20IMDb%20Max%20Weighted%20Rating.ipynb) | Thought Works |
| 3   | [Students DB](/Coding%20Ninjas/Easy/03-%20Students%20DB/03-%20Students%20DB.ipynb) | TCS |
| 4   | [Big Countries](/Coding%20Ninjas/Easy/04-%20Big%20Countries/04-%20Big%20Countries.ipynb) | IBM, Infosys |
| 5   | [Sales Executive](/Coding%20Ninjas/Easy/05-%20Sales%20Executive/05-%20Sales%20Executive.ipynb) | Wipro |

<details>
<summary>Click to expand full table...</summary>
  
| ID  | Challenge & Solution Script | Company |
|---- |-----------------------------|---------|
| 6   | [Director's Actor](/Coding%20Ninjas/Easy/06-%20Director's%20Actor/06-%20Director's%20Actor.ipynb) | Company F |
| 7   | [Combine Two Tables](/Coding%20Ninjas/Easy/07-%20Combine%20Two%20Tables/07-%20Combine%20Two%20Tables.ipynb) | Company G |
| 8   | [Swap Salary](/Coding%20Ninjas/Easy/08-%20Swap%20Salary/08-%20Swap%20Salary.ipynb) | Company H |
| 9   | [Rank Scores](/Coding%20Ninjas/Easy/09-%20Rank%20Scores/09-%20Rank%20Scores.ipynb) | Company I |
| 10  | [Warehouse Manager](/Coding%20Ninjas/Easy/10-%20Warehouse%20Manager/10-%20Warehouse%20Manager.ipynb) | Company J |
| 11  | [Article](/Coding%20Ninjas/Easy/11-%20Article/11-%20Article.ipynb) | Company K |
| 12  | [Marvel Cities](/Coding%20Ninjas/Easy/12-%20Marvel%20Cities/12-%20Marvel%20Cities.ipynb) | Company L |
| 13  | [Duplicate Emails](/Coding%20Ninjas/Easy/13-%20Duplicate%20Emails/13-%20Duplicate%20Emails.ipynb) | Company M |
| 14  | [Customer Placing the Largest Number Orders](/Coding%20Ninjas/Easy/14-%20Customer%20Placing%20the%20Largest%20Number%20Orders/14-%20Customer%20Placing%20the%20Largest%20Number%20Orders.ipynb) | Company N |
| 15  | [Triangle Judgement](/Coding%20Ninjas/Easy/15-%20Triangle%20Judgement/15-%20Triangle%20Judgement.ipynb) | Company O |
| 16  | [The Most Frequently Ordered Products for Each Customer](/Coding%20Ninjas/Easy/16-%20The%20Most%20Frequently%20Ordered%20Products%20for%20Each%20Customer/16-%20The%20Most%20Frequently%20Ordered%20Products%20for%20Each%20Customer.ipynb) | Company P |
| 17  | [NPV Queries](/Coding%20Ninjas/Easy/17-%20NPV%20Queries/17-%20NPV%20Queries.ipynb) | Company Q |
| 18  | [Orders With Maximum Quantity Above Average](/Coding%20Ninjas/Easy/18-%20Orders%20With%20Maximum%20Quantity%20Above%20Average/18-%20Orders%20With%20Maximum%20Quantity%20Above%20Average.ipynb) | Company R |
| 19  | [Product's Worth Over Invoices](/Coding%20Ninjas/Easy/19-%20Product's%20Worth%20Over%20Invoices/19-%20Product's%20Worth%20Over%20Invoices.ipynb) | Company S |
| 20  | [Spotify Sessions](/Coding%20Ninjas/Easy/20-%20Spotify%20Sessions/20-%20Spotify%20Sessions.ipynb) | Company T |
</details>

---

## üü† Difficulty: Moderate (33/33) <a name="moderate"></a>


| ID  | Challenge & Solution Script | Company |
|---- |-----------------------------|---------|
| 1   | [IMDb Rating](/Coding%20Ninjas/Moderate/01-%20IMDb%20Rating/01-%20IMDb%20Rating.ipynb) | Company A |
| 2   | [Second Highest Salary](/Coding%20Ninjas/Moderate/02-%20Second%20Highest%20Salary/02-%20Second%20Highest%20Salary.ipynb) | Company B |
| 3   | [Number of Calls Between Two Persons](/Coding%20Ninjas/Moderate/03-%20Number%20of%20Calls%20Between%20Two%20Persons/03-%20Number%20of%20Calls%20Between%20Two%20Persons.ipynb) | Company C |
| 4   | [Geography Report](/Coding%20Ninjas/Moderate/04-%20Geography%20Report/04-%20Geography%20Report.ipynb) | Company D |
| 5   | [Recyclable and Low Fat Products](/Coding%20Ninjas/Moderate/05-%20Recyclable%20and%20Low%20Fat%20Products/05-%20Recyclable%20and%20Low%20Fat%20Products.ipynb) | Company E |

<details>
  
<summary>Click to expand full table...</summary>
  
| ID  | Challenge & Solution Script | Company |
|---- |-----------------------------|---------| 
| 6   | [Ad-Free Sessions](/Coding%20Ninjas/Moderate/06-%20Ad-Free%20Sessions/06-%20Ad-Free%20Sessions.ipynb) | Company F |
| 7   | [Patients With a Condition](/Coding%20Ninjas/Moderate/07-%20Patients%20With%20a%20Condition/07-%20Patients%20With%20a%20Condition.ipynb) | Company G |
| 8   | [Fix the Issue](/Coding%20Ninjas/Moderate/08-%20Fix%20the%20Issue/08-%20Fix%20the%20Issue.ipynb) | Company H |
| 9   | [Shortest Distance](/Coding%20Ninjas/Moderate/09-%20Shortest%20Distance/09-%20Shortest%20Distance.ipynb) | Company I |
| 10  | [Classes with more than 5 students](/Coding%20Ninjas/Moderate/10-%20Classes%20with%20more%20than%205%20students/10-%20Classes%20with%20more%20than%205%20students.ipynb) | Company J |
| 11  | [Employees Earning More Than Their Manager](/Coding%20Ninjas/Moderate/11-%20Employees%20Earning%20More%20Than%20Their%20Manager/11-%20Employees%20Earning%20More%20Than%20Their%20Manager.ipynb) | Company K |
| 12  | [Customers Who Never Order](/Coding%20Ninjas/Moderate/12-%20Customers%20Who%20Never%20Order/12-%20Customers%20Who%20Never%20Order.ipynb) | Company L |
| 13  | [Delete Duplicate emails](/Coding%20Ninjas/Moderate/13-%20Delete%20Duplicate%20emails/13-%20Delete%20Duplicate%20emails.ipynb) | Company M |
| 14  | [Employee Bonus](/Coding%20Ninjas/Moderate/14-%20Employee%20Bonus/14-%20Employee%20Bonus.ipynb) | Company N |
| 15  | [Friend Request](/Coding%20Ninjas/Moderate/15-%20Friend%20Request/15-%20Friend%20Request.ipynb) | Company O |
| 16  | [Consecutive Available Seats](/Coding%20Ninjas/Moderate/16-%20Consecutive%20Available%20Seats/16-%20Consecutive%20Available%20Seats.ipynb) | Company P |
| 17  | [Biggest Single Number](/Coding%20Ninjas/Moderate/17-%20Biggest%20Single%20Number/17-%20Biggest%20Single%20Number.ipynb) | Company Q |
| 18  | [Not Boring Movies](/Coding%20Ninjas/Moderate/18-%20Not%20Boring%20Movies/18-%20Not%20Boring%20Movies.ipynb) | Company R |
| 19  | [Reformat Department Table](/Coding%20Ninjas/Moderate/19-%20Reformat%20Department%20Table/19-%20Reformat%20Department%20Table.ipynb) | Company S |
| 20  | [Queries Quality and Percentage](/Coding%20Ninjas/Moderate/20-%20Queries%20Quality%20and%20Percentage/20-%20Queries%20Quality%20and%20Percentage.ipynb) | Company T |
| 21  | [Create a Session Bar Chart](/Coding%20Ninjas/Moderate/21-%20Create%20a%20Session%20Bar%20Chart/21-%20Create%20a%20Session%20Bar%20Chart.ipynb) | Company U |
| 22  | [Number of Comments per Post](/Coding%20Ninjas/Moderate/22-%20Number%20of%20Comments%20per%20Post/22-%20Number%20of%20Comments%20per%20Post.ipynb) | Company V |
| 23  | [Customers Who Bought All Products](/Coding%20Ninjas/Moderate/23-%20Customers%20Who%20Bought%20All%20Products/23-%20Customers%20Who%20Bought%20All%20Products.ipynb) | Company W |
| 24  | [Apples & Oranges](/Coding%20Ninjas/Moderate/24-%20Apples%20&%20Oranges/24-%20Apples%20&%20Oranges.ipynb) | Company X |
| 25  | [Running Total for Different Genders](/Coding%20Ninjas/Moderate/25-%20Running%20Total%20for%20Different%20Genders/25-%20Running%20Total%20for%20Different%20Genders.ipynb) | Company Y |
| 26  | [Activity Participants](/Coding%20Ninjas/Moderate/26-%20Activity%20Participants/26-%20Activity%20Participants.ipynb) | Company Z |
| 27  | [Group Employees of the Same Salary](/Coding%20Ninjas/Moderate/27-%20Group%20Employees%20of%20the%20Same%20Salary/27-%20Group%20Employees%20of%20the%20Same%20Salary.ipynb) | Company AA |
| 28  | [Count Salary Categories](/Coding%20Ninjas/Moderate/28-%20Count%20Salary%20Categories/28-%20Count%20Salary%20Categories.ipynb) | Company BB |
| 29  | [Confirmation of Signups](/Coding%20Ninjas/Moderate/29-%20Confirmation%20of%20Signups/29-%20Confirmation%20of%20Signups.ipynb) | Company CC |
| 30  | [All the Pairs With the Maximum Number of Common Followers](/Coding%20Ninjas/Moderate/30-%20All%20the%20Pairs%20With%20the%20Maximum%20Number%20of%20Common%20Followers/30-%20All%20the%20Pairs%20With%20the%20Maximum%20Number%20of%20Common%20Followers.ipynb) | Company DD |
| 31  | [The Latest Login in 2020](/Coding%20Ninjas/Moderate/31-%20The%20Latest%20Login%20in%202020/31-%20The%20Latest%20Login%20in%202020.ipynb) | Company EE |
| 32  | [Sellers With No Sales](/Coding%20Ninjas/Moderate/32-%20Sellers%20With%20No%20Sales/32-%20Sellers%20With%20No%20Sales.ipynb) | Company FF |
| 33  | [Fix Names in a Table](/Coding%20Ninjas/Moderate/33-%20Fix%20Names%20in%20a%20Table/33-%20Fix%20Names%20in%20a%20Table.ipynb) | Company GG |
</details>

---

## üî¥ Difficulty: Hard (29/29) <a name="hard"></a>
| ID  | Challenge & Solution Script                                    | Company                                      |
|---- |----------------------------------------------- |---------------------------------------------- |
| 01  | [IMDB genre](/Coding%20Ninjas/Hard/01-%20IMDB%20Genre/01-%20IMDB%20Genre.ipynb) | Intuit                                       |
| 02  | [Rising Temperature](/Coding%20Ninjas/Hard/02-%20Rising%20Temperature/02-%20Rising%20Temperature.ipynb) | Amazon, Google                               |
| 03  | [Consecutive Numbers](/Coding%20Ninjas/Hard/03-%20Consecutive%20Numbers/03-%20Consecutive%20Numbers.ipynb) | Flipkart                                     |
| 04  | [Winning Candidate](/Coding%20Ninjas/Hard/04-%20Winning%20Candidate/04-%20Winning%20Candidate.ipynb) | Meta                                         |
| 05  | [Count Student Number in Departments](/Coding%20Ninjas/Hard/05-%20Count%20Student%20Number%20in%20Departments/05-%20Count%20Student%20Number%20in%20Departments.ipynb) | Citibank                                     |

<details>
<summary>Click to expand full table...</summary>
  
| ID  | Challenge & Solution Script                                    | Company                                      |
|---- |----------------------------------------------- |---------------------------------------------- |
| 06  | [Exchange Seats](/Coding%20Ninjas/Hard/06-%20Exchange%20Seats/06-%20Exchange%20Seats.ipynb) | Morgan Stanley                               |
| 07  | [Second Degree Follower](/Coding%20Ninjas/Hard/07-%20Second%20Degree%20Follower/07-%20Second%20Degree%20Follower.ipynb) | Groww                                        |
| 08  | [Biggest Window between Visits](/Coding%20Ninjas/Hard/08-%20Biggest%20Window%20between%20Visits/08-%20Biggest%20Window%20between%20Visits.ipynb) | Myntra, Goldman Sachs                        |
| 09  | [CN Banned](/Coding%20Ninjas/Hard/09-%20CN%20Banned/09-%20CN%20Banned.ipynb) | Morgan Stanley                               |
| 10  | [Maximum Transaction Each Day](/Coding%20Ninjas/Hard/10-%20Maximum%20Transaction%20Each%20Day/10-%20Maximum%20Transaction%20Each%20Day.ipynb) | Walmart                                      |
| 11  | [Department Top 3 Salaries](/Coding%20Ninjas/Hard/11-%20Department%20Top%203%20Salaries/11-%20Department%20Top%203%20Salaries.ipynb) | Microsoft                                    |
| 12  | [Immediate Food Delivery](/Coding%20Ninjas/Hard/12-%20Immediate%20Food%20Delivery/12-%20Immediate%20Food%20Delivery.ipynb) | MakeMyTrip                                   |
| 13  | [All Valid Triplets that can represent a Country](/Coding%20Ninjas/Hard/13-%20All%20Valid%20Triplets%20that%20can%20represent%20a%20Country/13-%20All%20Valid%20Triplets%20that%20can%20represent%20a%20Country.ipynb) | Thought Works, Microsoft, Siemens            |
| 14  | [Median Employee Salary](/Coding%20Ninjas/Hard/14-%20Median%20Employee%20Salary/14-%20Median%20Employee%20Salary.ipynb) | Goldman Sachs                                |
| 15  | [Get the Second Most Activity](/Coding%20Ninjas/Hard/15-%20Get%20the%20Second%20Most%20Activity/15-%20Get%20the%20Second%20Most%20Activity.ipynb) | Amazon, Goldman Sachs                        |
| 16  | [Find the Quiet Students in All Exams](/Coding%20Ninjas/Hard/16-%20Find%20the%20Quiet%20Students%20in%20All%20Exams/16-%20Find%20the%20Quiet%20Students%20in%20All%20Exams.ipynb) | Morgan Stanley, Walmart                      |
| 17  | [Find Cumulative Salary of an Employee](/Coding%20Ninjas/Hard/17-%20Find%20Cumulative%20Salary%20of%20an%20Employee/17-%20Find%20Cumulative%20Salary%20of%20an%20Employee.ipynb) | Linkedin, Sprinklr                           |
| 18  | [Find the Team Size](/Coding%20Ninjas/Hard/18-%20Find%20the%20Team%20Size/18-%20Find%20the%20Team%20Size.ipynb) | Meta, Siemens                                |
| 19  | [Top Travellers](/Coding%20Ninjas/Hard/19-%20Top%20Travellers/19-%20Top%20Travellers.ipynb) | IBM, Amazon                                  |
| 20  | [New Users Daily Count](/Coding%20Ninjas/Hard/20-%20New%20Users%20Daily%20Count/20-%20New%20Users%20Daily%20Count.ipynb) | Goldman Sachs                                |
| 21  | [Active Businesses](/Coding%20Ninjas/Hard/21-%20Active%20Businesses/21-%20Active%20Businesses.ipynb) | Samsung                                      |
| 22  | [Last Person to fit in the Bus](/Coding%20Ninjas/Hard/22-%20Last%20Person%20to%20fit%20in%20the%20Bus/22-%20Last%20Person%20to%20fit%20in%20the%20Bus.ipynb) | Flipkart                                     |
| 23  | [Capital Gain Loss](/Coding%20Ninjas/Hard/23-%20Capital%20Gain%20Loss/23-%20Capital%20Gain%20Loss.ipynb) | MakeMyTrip                                   |
| 24  | [Calculate Salaries](/Coding%20Ninjas/Hard/24-%20Calculate%20Salaries/24-%20Calculate%20Salaries.ipynb) | Atlassian, HSBC                              |
| 25  | [Evaluate Bool Expressions](/Coding%20Ninjas/Hard/25-%20Evaluate%20Bool%20Expressions/25-%20Evaluate%20Bool%20Expressions.ipynb) | Atlassian                                    |
| 26  | [Page Recommendations](/Coding%20Ninjas/Hard/26-%20Page%20Recommendations/26-%20Page%20Recommendations.ipynb) | Samsung                                      |
| 27  | [Trusted Contacts of User](/Coding%20Ninjas/Hard/27-%20Trusted%20Contacts%20of%20User/27-%20Trusted%20Contacts%20of%20User.ipynb) | Morgan Stanley, Goldman Sachs                |
| 28  | [Strong & Steady Friendship](/Coding%20Ninjas/Hard/28-%20Strong%20&%20Steady%20Friendship/28-%20Strong%20&%20Steady%20Friendship.ipynb) | Thought Works, Siemens                       |
| 29  | [Percentage of Users attended a Contest](/Coding%20Ninjas/Hard/29-%20Percentage%20of%20Users%20attended%20a%20Contest/29-%20Percentage%20of%20Users%20attended%20a%20Contest.ipynb) | Thought Works all 29 ques                    |
</details>

---

## üü£ Difficulty: Ninjas (16/16) <a name="ninjas"></a>

| ID  |  Challenge & Solution Script                                   | Company                                      |
|---- |----------------------------------------------- |---------------------------------------------- |
| 01  | [Department Highest Salary](/Coding%20Ninjas/Hard/01-%20Department%20Highest%20Salary/01-%20Department%20Highest%20Salary.ipynb) | Google, VMware Inc.                          |
| 02  | [Managers with at least 5 direct Reports](/Coding%20Ninjas/Hard/02-%20Managers%20with%20at%20least%205%20direct%20Reports/02-%20Managers%20with%20at%20least%205%20direct%20Reports.ipynb) | Dunzo                                        |
| 03  | [Investments in 2016](/Coding%20Ninjas/Hard/03-%20Investments%20in%202016/03-%20Investments%20in%202016.ipynb) | Oracle                                       |
| 04  | [Tree Node](/Coding%20Ninjas/Hard/04-%20Tree%20Node/04-%20Tree%20Node.ipynb) | JP Morgan, Google                            |
| 05  | [Shortest Distance in a Plane](/Coding%20Ninjas/Hard/05-%20Shortest%20Distance%20in%20a%20Plane/05-%20Shortest%20Distance%20in%20a%20Plane.ipynb) | Adobe                                        |

<details>
<summary>Click to expand full table...</summary>

| ID  |  Challenge & Solution Script                                    | Company                                      |
|---- |----------------------------------------------- |----------------------------------------------|
| 06  | [Find the Missing ID's](/Coding%20Ninjas/Hard/06-%20Find%20the%20Missing%20ID's/06-%20Find%20the%20Missing%20ID's.ipynb) | Amazon                                       |
| 07  | [Premier League Stats](/Coding%20Ninjas/Hard/07-%20Premier%20League%20Stats/07-%20Premier%20League%20Stats.ipynb) | Google, ZS Associates                        |
| 08  | [Human Traffic Stadium](/Coding%20Ninjas/Hard/08-%20Human%20Traffic%20Stadium/08-%20Human%20Traffic%20Stadium.ipynb) | Deutsche Bank                                |
| 09  | [Report Contiguous Dates](/Coding%20Ninjas/Hard/09-%20Report%20Contiguous%20Dates/09-%20Report%20Contiguous%20Dates.ipynb) | Google                                       |
| 10  | [Transactions per Visit](/Coding%20Ninjas/Hard/10-%20Transactions%20per%20Visit/10-%20Transactions%20per%20Visit.ipynb) | Microsoft, Morgan Stanley                    |
| 11  | [Highest Grade for each Student](/Coding%20Ninjas/Hard/11-%20Highest%20Grade%20for%20each%20Student/11-%20Highest%20Grade%20for%20each%20Student.ipynb) | Microsoft                                    |
| 12  | [Product Price at a Given Date](/Coding%20Ninjas/Hard/12-%20Product%20Price%20at%20a%20Given%20Date/12-%20Product%20Price%20at%20a%20Given%20Date.ipynb) | Meta, HSBC                                   |
| 13  | [Rectangles Area](/Coding%20Ninjas/Hard/13-%20Rectangles%20Area/13-%20Rectangles%20Area.ipynb) | Morgan Stanley, JP Morgan                    |
| 14  | [Bank Account Summary](/Coding%20Ninjas/Hard/14-%20Bank%20Account%20Summary/14-%20Bank%20Account%20Summary.ipynb) | Google, Microsoft, Amazon, VMware Inc.       |
| 15  | [Countries you can safely visit in](/Coding%20Ninjas/Hard/15-%20Countries%20you%20can%20safely%20visit%20in/15-%20Countries%20you%20can%20safely%20visit%20in.ipynb) | Groww, Microsoft, Meta, Google               |
| 16  | [Suspicious Bank Accounts](/Coding%20Ninjas/Hard/16-%20Suspicious%20Bank%20Accounts/16-%20Suspicious%20Bank%20Accounts.ipynb) | Intuit, Google                               |

</details>

---

## üìö References
üîπ The questions are sourced from the Coding Ninjas platform, which can be accessed at **[Click here](https://www.naukri.com/code360/problems?category[]=SQL%20Databases)**



---

## üéØ Contributing
Contributions are always welcome! üéâ

‚úÖ **Fork** the repository.  
‚úÖ **Make improvements**.  
‚úÖ **Submit a pull request**.  

Let's make this an awesome SQL resource together! üöÄ

---

## üí¨ Support
üì© Need help or have suggestions? Feel free to **[connect with me on LinkedIn](#)**.

‚≠ê If this repository helped you, don‚Äôt forget to **star** it! ‚ú®

